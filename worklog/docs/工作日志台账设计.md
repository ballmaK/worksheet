# 工作日志台账页面设计文档

## 1. 功能概述
工作日志台账页面是系统的核心功能，用于展示和管理所有工作日志记录，提供多维度的数据统计和分析功能。

## 2. 页面布局设计

### 2.1 页面结构
```
┌─────────────────────────────────────────────────────────────┐
│ 页面标题: 工作日志台账                                        │
├─────────────────────────────────────────────────────────────┤
│ 筛选条件区域                                                 │
│ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ │
│ │时间范围 │ │项目筛选 │ │用户筛选 │ │状态筛选 │ │搜索框   │ │
│ └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘ │
├─────────────────────────────────────────────────────────────┤
│ 统计概览区域                                                 │
│ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ │
│ │总工时   │ │今日工时 │ │本周工时 │ │本月工时 │ │平均工时 │ │
│ │8.5h     │ │2.5h     │ │32.5h    │ │156.5h   │ │7.8h/天  │ │
│ └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘ │
├─────────────────────────────────────────────────────────────┤
│ 操作按钮区域                                                 │
│ [新增日志] [批量导出] [批量删除] [刷新数据] [视图切换]        │
├─────────────────────────────────────────────────────────────┤
│ 数据展示区域                                                 │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 表格视图 / 卡片视图 / 日历视图                           │ │
│ │                                                         │ │
│ │ 表格列: 日期 | 用户 | 项目 | 任务 | 工时 | 状态 | 操作   │ │
│ │                                                         │ │
│ └─────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────┤
│ 分页区域                                                     │
│ [上一页] [1] [2] [3] ... [下一页] 共 100 条记录              │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 筛选条件设计
- **时间范围**: 今日、本周、本月、自定义日期范围
- **项目筛选**: 全部项目、指定项目、我的项目
- **用户筛选**: 全部用户、指定用户、我的日志
- **状态筛选**: 全部状态、进行中、已完成、已暂停
- **搜索框**: 支持按任务名称、工作内容、备注进行模糊搜索

### 2.3 统计概览设计
- **总工时**: 筛选条件下的总工作时间
- **今日工时**: 今日已记录的工作时间
- **本周工时**: 本周累计工作时间
- **本月工时**: 本月累计工作时间
- **平均工时**: 筛选条件下的平均每日工时

## 3. 数据展示模式

### 3.1 表格视图
```
┌─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┐
│ 日期    │ 用户    │ 项目    │ 任务    │ 工时    │ 状态    │ 操作    │
├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ 2024-12-│ 张三    │ 项目A   │ 功能开发│ 8.5h    │ 已完成  │ [编辑]  │
│ 19      │         │         │         │         │         │ [删除]  │
├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ 2024-12-│ 李四    │ 项目B   │ 测试    │ 6.0h    │ 进行中  │ [编辑]  │
│ 19      │         │         │         │         │         │ [删除]  │
└─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┘
```

### 3.2 卡片视图
```
┌─────────────────────────────────────────────────────────────┐
│ 2024-12-19 张三 - 项目A                                      │
│ 任务: 用户管理模块开发                                        │
│ 工时: 8.5小时 | 状态: 已完成                                  │
│ 内容: 完成了用户注册、登录、权限管理等功能...                 │
│ [编辑] [删除] [查看详情]                                      │
└─────────────────────────────────────────────────────────────┘
```

### 3.3 日历视图
```
┌─────────────────────────────────────────────────────────────┐
│                   2024年12月                                │
├─────┬─────┬─────┬─────┬─────┬─────┬─────┐                   │
│ 周日 │ 周一 │ 周二 │ 周三 │ 周四 │ 周五 │ 周六 │               │
├─────┼─────┼─────┼─────┼─────┼─────┼─────┤                   │
│     │     │     │     │     │     │  1  │                   │
│     │     │     │     │     │     │8.5h │                   │
├─────┼─────┼─────┼─────┼─────┼─────┼─────┤                   │
│  2  │  3  │  4  │  5  │  6  │  7  │  8  │                   │
│6.0h │7.5h │8.0h │6.5h │8.0h │5.5h │4.0h │                   │
└─────┴─────┴─────┴─────┴─────┴─────┴─────┘                   │
└─────────────────────────────────────────────────────────────┘
```

## 4. 功能特性

### 4.1 数据操作
- **新增日志**: 快速添加工作日志
- **编辑日志**: 修改已有日志内容
- **删除日志**: 删除不需要的日志
- **批量操作**: 支持批量删除、批量导出
- **数据导出**: 支持Excel、PDF格式导出

### 4.2 数据统计
- **工时统计**: 按日、周、月统计工时
- **项目统计**: 各项目工时分布
- **用户统计**: 各用户工作量统计
- **趋势分析**: 工时变化趋势图表

### 4.3 权限控制
- **查看权限**: 只能查看有权限的日志
- **编辑权限**: 只能编辑自己的日志
- **删除权限**: 只能删除自己的日志
- **管理权限**: 管理员可以管理所有日志

## 5. API接口设计

### 5.1 获取日志列表
```http
GET /api/v1/work-logs/ledger
Query Parameters:
- start_date: 开始日期 (YYYY-MM-DD)
- end_date: 结束日期 (YYYY-MM-DD)
- project_id: 项目ID
- user_id: 用户ID
- status: 状态 (in_progress, completed, paused)
- keyword: 搜索关键词
- page: 页码
- size: 每页数量
```

### 5.2 获取统计信息
```http
GET /api/v1/work-logs/statistics
Query Parameters:
- start_date: 开始日期
- end_date: 结束日期
- project_id: 项目ID
- user_id: 用户ID
```

### 5.3 批量操作
```http
POST /api/v1/work-logs/batch
Body:
{
  "action": "delete|export",
  "ids": [1, 2, 3, ...]
}
```

## 6. 技术实现要点

### 6.1 前端技术要点
- **响应式设计**: 支持桌面和移动端
- **组件复用**: 设计可复用的UI组件
- **状态管理**: 使用Pinia管理复杂状态
- **实时更新**: WebSocket实现实时数据更新
- **图表展示**: 使用ECharts或Chart.js展示统计图表

### 6.2 后端技术要点
- **数据聚合**: 高效的数据库查询和聚合
- **缓存策略**: Redis缓存热点数据
- **权限控制**: 细粒度的权限管理
- **实时推送**: WebSocket推送动态更新
- **数据导出**: 支持多种格式的数据导出

### 6.3 数据库优化
- **索引优化**: 为常用查询字段添加索引
- **分页查询**: 大数据量的分页优化
- **关联查询**: 优化多表关联查询性能
- **数据统计**: 预计算常用统计数据

# 项目管理页面设计文档

## 1. 功能概述
项目管理页面提供详细的项目信息展示、任务管理、进度跟踪、成员协作等功能，是项目管理的核心界面。

## 2. 页面布局设计

### 2.1 项目概览页面
```
┌─────────────────────────────────────────────────────────────┐
│ 项目管理 - [项目名称]                                        │
├─────────────────────────────────────────────────────────────┤
│ 项目信息头部                                                 │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 项目名称: 电商平台开发                                    │ │
│ │ 项目描述: 开发一个完整的电商平台，包含用户管理、商品管理、│ │
│ │          订单管理、支付系统等功能                        │ │
│ │ 进度: 75% ████████████████████░░░░░░░░░░░░░░░░░░░░░░░░░░ │ │
│ │ 状态: 进行中 | 优先级: 高 | 负责人: 张三                   │ │
│ │ 开始时间: 2024-01-01 | 预计完成: 2024-06-30               │ │
│ │ [编辑项目] [项目设置] [导出项目] [删除项目]                │ │
│ └─────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────┤
│ 功能导航标签                                                 │
│ [概览] [任务] [成员] [文档] [动态] [设置]                    │
├─────────────────────────────────────────────────────────────┤
│ 内容展示区域                                                 │
│ (根据选择的标签显示不同内容)                                  │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 项目概览标签页
```
┌─────────────────────────────────────────────────────────────┐
│ 项目概览                                                     │
├─────────────────────────────────────────────────────────────┤
│ 统计卡片区域                                                 │
│ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ │
│ │总任务   │ │已完成   │ │进行中   │ │待开始   │ │总工时   │ │
│ │25个     │ │18个     │ │5个      │ │2个      │ │156.5h   │ │
│ └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘ │
├─────────────────────────────────────────────────────────────┤
│ 进度图表区域                                                 │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 项目进度趋势图                                           │ │
│ │                                                         │ │
│ │ 100% ████████████████████████████████████████████████████ │ │
│ │  80% ████████████████████████████████████████████████░░░░ │ │
│ │  60% ████████████████████████████████████████████░░░░░░░░ │ │
│ │  40% ████████████████████████████████████░░░░░░░░░░░░░░░░ │ │
│ │  20% ████████████████████████░░░░░░░░░░░░░░░░░░░░░░░░░░░░ │ │
│ │   0% ████████████████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ │ │
│ │      1月  2月  3月  4月  5月  6月                        │ │
│ └─────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────┤
│ 最近活动区域                                                 │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 最近活动                                                 │ │
│ │ 2024-12-19 14:30 张三完成了任务"用户管理模块开发"          │ │
│ │ 2024-12-19 12:15 李四创建了新任务"商品管理模块"            │ │
│ │ 2024-12-19 10:00 王五更新了项目进度为75%                  │ │
│ │ 2024-12-18 16:45 赵六加入了项目                           │ │
│ └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

### 2.3 任务管理标签页
```
┌─────────────────────────────────────────────────────────────┐
│ 任务管理                                                     │
├─────────────────────────────────────────────────────────────┤
│ 操作区域                                                     │
│ [新建任务] [批量操作] [导入任务] [导出任务] [视图切换]        │
├─────────────────────────────────────────────────────────────┤
│ 筛选条件                                                     │
│ [全部任务] [我的任务] [待开始] [进行中] [已完成] [已暂停]     │
├─────────────────────────────────────────────────────────────┤
│ 任务列表                                                     │
│ ┌─────────┬─────────┬─────────┬─────────┬─────────┬─────────┐ │
│ │ 任务名称│ 负责人  │ 优先级  │ 状态    │ 进度    │ 截止日期│ │
│ ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤ │
│ │用户管理 │ 张三    │ 高      │ 已完成  │ 100%    │ 12-20   │ │
│ │模块开发 │         │         │         │         │         │ │
│ ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤ │
│ │商品管理 │ 李四    │ 中      │ 进行中  │ 60%     │ 12-25   │ │
│ │模块开发 │         │         │         │         │         │ │
│ ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤ │
│ │订单管理 │ 王五    │ 高      │ 待开始  │ 0%      │ 12-30   │ │
│ │模块开发 │         │         │         │         │         │ │
│ └─────────┴─────────┴─────────┴─────────┴─────────┴─────────┘ │
└─────────────────────────────────────────────────────────────┘
```

## 3. 功能特性

### 3.1 项目概览
- **项目信息**: 显示项目基本信息、进度、状态
- **统计图表**: 任务完成情况、工时统计、进度趋势
- **最近活动**: 项目相关的最新动态
- **快速操作**: 编辑项目、项目设置、导出数据

### 3.2 任务管理
- **任务列表**: 显示项目所有任务
- **任务状态**: 待开始、进行中、已完成、已暂停
- **任务优先级**: 高、中、低优先级管理
- **任务分配**: 分配给指定成员
- **进度跟踪**: 实时更新任务进度
- **任务依赖**: 设置任务之间的依赖关系
- **工时记录**: 记录任务实际工时

### 3.3 成员协作
- **成员管理**: 邀请、移除项目成员
- **角色分配**: 负责人、开发、测试等角色
- **权限控制**: 不同角色拥有不同权限
- **工作量统计**: 各成员的任务数和工时统计
- **在线状态**: 显示成员在线状态

### 3.4 项目文档
- **文档管理**: 项目相关文档上传、管理
- **版本控制**: 文档版本管理
- **协作编辑**: 支持多人协作编辑
- **文档分类**: 按类型分类管理文档
- **文档搜索**: 全文搜索文档内容
- **文档预览**: 在线预览文档内容

### 3.5 项目动态
- **实时更新**: 项目活动实时显示
- **动态类型**: 任务完成、成员加入、文档上传等
- **时间线展示**: 按时间顺序展示动态
- **筛选功能**: 按类型、时间筛选动态
- **通知推送**: 重要动态推送通知

## 4. API接口设计

### 4.1 获取项目详情
```http
GET /api/v1/projects/{project_id}
```

### 4.2 更新项目信息
```http
PUT /api/v1/projects/{project_id}
Body:
{
  "name": "项目名称",
  "description": "项目描述",
  "status": "in_progress|completed|paused",
  "priority": "high|medium|low",
  "start_date": "2024-01-01",
  "end_date": "2024-06-30",
  "progress": 75
}
```

### 4.3 获取项目任务列表
```http
GET /api/v1/projects/{project_id}/tasks
Query Parameters:
- status: 任务状态
- assignee_id: 负责人ID
- priority: 优先级
- keyword: 搜索关键词
- page: 页码
- size: 每页数量
```

### 4.4 创建项目任务
```http
POST /api/v1/projects/{project_id}/tasks
Body:
{
  "title": "任务标题",
  "description": "任务描述",
  "assignee_id": 1,
  "priority": "high|medium|low",
  "estimated_hours": 40,
  "due_date": "2024-12-25"
}
```

### 4.5 获取项目成员
```http
GET /api/v1/projects/{project_id}/members
```

### 4.6 获取项目统计信息
```http
GET /api/v1/projects/{project_id}/statistics
```

### 4.7 获取项目动态
```http
GET /api/v1/projects/{project_id}/activities
Query Parameters:
- type: 动态类型
- start_date: 开始日期
- end_date: 结束日期
- page: 页码
- size: 每页数量
```

## 5. 数据模型设计

### 5.1 项目任务模型
```python
class ProjectTask(Base):
    __tablename__ = "project_tasks"
    
    id = Column(Integer, primary_key=True, index=True)
    project_id = Column(Integer, ForeignKey("projects.id"))
    title = Column(String(200), nullable=False)
    description = Column(Text)
    assignee_id = Column(Integer, ForeignKey("users.id"))
    status = Column(Enum("pending", "in_progress", "completed", "paused"), default="pending")
    priority = Column(Enum("low", "medium", "high"), default="medium")
    progress = Column(Integer, default=0)  # 0-100
    estimated_hours = Column(Float)
    actual_hours = Column(Float, default=0)
    due_date = Column(Date)
    created_at = Column(DateTime, default=datetime.utcnow)
    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)
    
    project = relationship("Project", back_populates="tasks")
    assignee = relationship("User", back_populates="assigned_tasks")
```

### 5.2 项目活动模型
```python
class ProjectActivity(Base):
    __tablename__ = "project_activities"
    
    id = Column(Integer, primary_key=True, index=True)
    project_id = Column(Integer, ForeignKey("projects.id"))
    user_id = Column(Integer, ForeignKey("users.id"))
    activity_type = Column(String(50))  # task_created, task_completed, member_joined, document_uploaded
    title = Column(String(200))
    content = Column(Text)
    metadata = Column(JSON)  # 存储活动相关的额外数据
    created_at = Column(DateTime, default=datetime.utcnow)
    
    project = relationship("Project", back_populates="activities")
    user = relationship("User", back_populates="project_activities")
```

## 6. 技术实现要点

### 6.1 前端技术要点
- **标签页切换**: 使用Vue Router或组件切换
- **实时更新**: WebSocket推送项目动态
- **文件上传**: 文档上传和预览功能
- **图表展示**: 使用ECharts展示项目统计图表
- **权限控制**: 基于角色的UI显示控制
- **拖拽排序**: 任务列表拖拽排序功能

### 6.2 后端技术要点
- **权限验证**: 项目操作权限验证
- **实时推送**: WebSocket推送项目动态
- **文件处理**: 文档上传、存储和预览
- **数据关联**: 项目、任务、成员、文档的关联查询
- **活动记录**: 自动记录项目相关活动
- **进度计算**: 自动计算项目整体进度

### 6.3 数据库优化
- **关联查询**: 优化项目相关查询性能
- **索引设计**: 为常用查询字段添加索引
- **分页查询**: 大数据量的分页优化
- **缓存策略**: 缓存项目基本信息和统计数据

## 7. 开发优先级建议

### 7.1 第一阶段：项目概览和任务管理
**优先级**: 最高
**功能**: 项目基本信息展示、任务CRUD操作
**开发时间**: 3-4天

### 7.2 第二阶段：成员管理和项目动态
**优先级**: 高
**功能**: 成员邀请、角色管理、动态记录
**开发时间**: 2-3天

### 7.3 第三阶段：文档管理和高级功能
**优先级**: 中
**功能**: 文档上传、版本控制、统计图表
**开发时间**: 3-4天
